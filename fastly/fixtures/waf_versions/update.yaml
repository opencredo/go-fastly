---
version: 1
interactions:
- request:
    body: |
      {"data":{"type":"waf_firewall","id":"1qMZVWZH5GLNK20IVDPDUb","attributes":{"http_violation_score_threshold":80}}}
    form: {}
    headers:
      Accept:
      - application/vnd.api+json
      Content-Type:
      - application/vnd.api+json
      User-Agent:
      - FastlyGo/1.3.0 (+github.com/fastly/go-fastly; go1.13.4)
    url: https://api.fastly.com/waf/firewalls/0EkLguGf2kIYDTVY5MRO2D/versions/2
    method: PATCH
  response:
    body: '{"data":{"id":"1qMZVWZH5GLNK20IVDPDUb","type":"waf_firewall_version","attributes":{"number":2,"comment":null,"active":null,"locked":false,"error":null,"deployed_at":null,"critical_anomaly_score":5,"error_anomaly_score":4,"warning_anomaly_score":3,"notice_anomaly_score":2,"http_violation_score_threshold":80,"inbound_anomaly_score_threshold":999,"lfi_score_threshold":999,"php_injection_score_threshold":999,"rce_score_threshold":999,"rfi_score_threshold":999,"session_fixation_score_threshold":999,"sql_injection_score_threshold":999,"xss_score_threshold":999,"paranoia_level":1,"arg_name_length":100,"arg_length":400,"total_arg_length":6400,"max_file_size":10000000,"combined_file_sizes":10000000,"max_num_args":255,"high_risk_country_codes":"","allowed_methods":"GET
      HEAD POST OPTIONS PUT PATCH DELETE","restricted_headers":"/proxy/ /lock-token/
      /content-range/ /translate/ /if/","restricted_extensions":".asa/ .asax/ .ascx/
      .axd/ .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/
      .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/
      .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/
      .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/
      .xsx/","allowed_request_content_type":"application/x-www-form-urlencoded|multipart/form-data|text/xml|application/xml|application/soap+xml|application/x-amf|application/json|application/octet-stream|application/csp-report|application/xss-auditor-report|text/plain","allowed_request_content_type_charset":"utf-8|iso-8859-1|iso-8859-15|windows-1252","allowed_http_versions":"HTTP/1.0
      HTTP/1.1 HTTP/2","crs_validate_utf8_encoding":false,"created_at":"2019-11-20T12:51:21Z","updated_at":"2019-11-20T12:51:21Z","active_rules_trustwave_log_count":0,"active_rules_trustwave_block_count":0,"active_rules_fastly_log_count":0,"active_rules_fastly_block_count":0,"active_rules_owasp_log_count":0,"active_rules_owasp_block_count":0,"active_rules_owasp_score_count":0},"relationships":{"waf_firewall":{"data":{"id":"0EkLguGf2kIYDTVY5MRO2D","type":"waf_firewall"}}}}}'
    headers:
      Accept-Ranges:
      - bytes
      Content-Length:
      - "2094"
      Content-Type:
      - application/vnd.api+json
      Date:
      - Wed, 20 Nov 2019 12:51:21 GMT
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=31536000
      Via:
      - 1.1 varnish
      X-Cache:
      - MISS, MISS
      X-Cache-Hits:
      - 0, 0
      X-Content-Type-Options:
      - nosniff
      X-Served-By:
      - cache-control-slwdc9036-CONTROL-SLWDC, cache-lcy19279-LCY
      X-Timer:
      - S1574254281.390804,VS0,VE283
    status: 200 OK
    code: 200
    duration: ""
